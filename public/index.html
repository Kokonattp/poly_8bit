<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolyTrader Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <style>
        :root {
            /* Light Theme - Material Design 3 */
            --md-primary: #6750A4;
            --md-on-primary: #FFFFFF;
            --md-primary-container: #EADDFF;
            --md-on-primary-container: #21005D;
            
            --md-secondary: #625B71;
            --md-on-secondary: #FFFFFF;
            --md-secondary-container: #E8DEF8;
            --md-on-secondary-container: #1D192B;
            
            --md-tertiary: #7D5260;
            --md-tertiary-container: #FFD8E4;
            
            --md-surface: #FFFBFE;
            --md-surface-dim: #DED8E1;
            --md-surface-container: #F3EDF7;
            --md-surface-container-high: #ECE6F0;
            --md-surface-container-highest: #E6E0E9;
            
            --md-on-surface: #1C1B1F;
            --md-on-surface-variant: #49454F;
            --md-outline: #79747E;
            --md-outline-variant: #CAC4D0;
            
            --md-error: #B3261E;
            --md-error-container: #F9DEDC;
            --md-on-error: #FFFFFF;
            
            --md-success: #146B3A;
            --md-success-container: #C8E6C9;
            
            --md-warning: #E65100;
            --md-warning-container: #FFE0B2;
            
            --md-info: #0277BD;
            --md-info-container: #B3E5FC;
            
            --shadow-1: 0 1px 2px rgba(0,0,0,0.3), 0 1px 3px 1px rgba(0,0,0,0.15);
            --shadow-2: 0 1px 2px rgba(0,0,0,0.3), 0 2px 6px 2px rgba(0,0,0,0.15);
            --shadow-3: 0 4px 8px 3px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.3);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 28px;
        }
        
        [data-theme="dark"] {
            --md-primary: #D0BCFF;
            --md-on-primary: #381E72;
            --md-primary-container: #4F378B;
            --md-on-primary-container: #EADDFF;
            
            --md-secondary: #CCC2DC;
            --md-on-secondary: #332D41;
            --md-secondary-container: #4A4458;
            --md-on-secondary-container: #E8DEF8;
            
            --md-tertiary: #EFB8C8;
            --md-tertiary-container: #633B48;
            
            --md-surface: #141218;
            --md-surface-dim: #141218;
            --md-surface-container: #211F26;
            --md-surface-container-high: #2B2930;
            --md-surface-container-highest: #36343B;
            
            --md-on-surface: #E6E1E5;
            --md-on-surface-variant: #CAC4D0;
            --md-outline: #938F99;
            --md-outline-variant: #49454F;
            
            --md-error: #F2B8B5;
            --md-error-container: #8C1D18;
            --md-on-error: #601410;
            
            --md-success: #81C784;
            --md-success-container: #1B5E20;
            
            --md-warning: #FFB74D;
            --md-warning-container: #E65100;
            
            --md-info: #4FC3F7;
            --md-info-container: #01579B;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Prompt', sans-serif;
            background: var(--md-surface);
            color: var(--md-on-surface);
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }
        
        /* Header */
        .header {
            background: var(--md-surface-container);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--md-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--md-on-primary);
            font-size: 20px;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--md-on-surface);
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .status-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--md-success-container);
            color: var(--md-success);
            border-radius: var(--radius-xl);
            font-size: 14px;
            font-weight: 500;
        }
        
        .status-chip.offline {
            background: var(--md-error-container);
            color: var(--md-error);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: currentColor;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Theme Toggle */
        .theme-toggle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: var(--md-surface-container-high);
            color: var(--md-on-surface);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .theme-toggle:hover {
            background: var(--md-surface-container-highest);
        }
        
        /* Main */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: var(--md-surface-container);
            padding: 8px;
            border-radius: var(--radius-xl);
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--md-on-surface-variant);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab-btn:hover {
            background: var(--md-surface-container-high);
        }
        
        .tab-btn.active {
            background: var(--md-primary);
            color: var(--md-on-primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Controls */
        .controls-card {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 24px;
        }
        
        .controls-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .control-group label {
            font-size: 12px;
            font-weight: 500;
            color: var(--md-on-surface-variant);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .input-field {
            padding: 12px 16px;
            border: 1px solid var(--md-outline);
            border-radius: var(--radius-sm);
            background: var(--md-surface);
            color: var(--md-on-surface);
            font-family: inherit;
            font-size: 16px;
            width: 140px;
            transition: all 0.2s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--md-primary);
            box-shadow: 0 0 0 2px var(--md-primary-container);
        }
        
        .search-field {
            flex: 1;
            min-width: 200px;
        }
        
        .search-field .input-field {
            width: 100%;
        }
        
        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-xl);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--md-primary);
            color: var(--md-on-primary);
        }
        
        .btn-primary:hover {
            box-shadow: var(--shadow-2);
        }
        
        .btn-tonal {
            background: var(--md-secondary-container);
            color: var(--md-on-secondary-container);
        }
        
        .btn-success {
            background: var(--md-success);
            color: white;
        }
        
        .btn-text {
            background: transparent;
            color: var(--md-primary);
        }
        
        /* Filter Chips */
        .filter-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }
        
        .filter-chip {
            padding: 8px 16px;
            border: 1px solid var(--md-outline);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--md-on-surface-variant);
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .filter-chip:hover {
            background: var(--md-surface-container-high);
        }
        
        .filter-chip.active {
            background: var(--md-secondary-container);
            color: var(--md-on-secondary-container);
            border-color: transparent;
        }
        
        /* Stats Row */
        .stats-row {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 14px;
            color: var(--md-on-surface-variant);
        }
        
        .stats-row span {
            color: var(--md-primary);
            font-weight: 600;
        }
        
        /* Market Grid */
        .market-grid {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        }
        
        /* Market Card */
        .market-card {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all 0.3s;
            position: relative;
        }
        
        .market-card:hover {
            box-shadow: var(--shadow-3);
            transform: translateY(-2px);
        }
        
        /* Hover Overlay */
        .hover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--md-surface-container-highest);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            padding: 20px;
            overflow-y: auto;
            z-index: 10;
        }
        
        .market-card:hover .hover-overlay {
            opacity: 1;
            visibility: visible;
        }
        
        .overlay-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--md-outline-variant);
        }
        
        .overlay-header h3 {
            font-size: 14px;
            font-weight: 600;
            color: var(--md-primary);
        }
        
        .overlay-section {
            margin-bottom: 16px;
        }
        
        .overlay-section h4 {
            font-size: 12px;
            font-weight: 600;
            color: var(--md-on-surface);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .overlay-section p,
        .overlay-section li {
            font-size: 13px;
            color: var(--md-on-surface-variant);
            line-height: 1.6;
        }
        
        .overlay-section ul {
            padding-left: 16px;
            margin: 0;
        }
        
        .overlay-section li {
            margin-bottom: 4px;
        }
        
        /* Profit Calculator Box */
        .profit-box {
            background: var(--md-surface-container);
            border-radius: var(--radius-md);
            padding: 12px;
            margin-bottom: 12px;
        }
        
        .profit-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--md-outline-variant);
        }
        
        .profit-row:last-child {
            border-bottom: none;
        }
        
        .profit-label {
            font-size: 13px;
            color: var(--md-on-surface-variant);
        }
        
        .profit-value {
            font-size: 14px;
            font-weight: 600;
        }
        
        .profit-value.positive {
            color: var(--md-success);
        }
        
        .profit-value.negative {
            color: var(--md-error);
        }
        
        .highlight-box {
            background: var(--md-primary-container);
            color: var(--md-on-primary-container);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 13px;
        }
        
        .overlay-footer {
            margin-top: auto;
            padding-top: 12px;
        }
        
        .overlay-footer .btn {
            width: 100%;
            justify-content: center;
        }
        
        /* Card Header */
        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--md-outline-variant);
        }
        
        .card-title {
            font-size: 15px;
            font-weight: 500;
            color: var(--md-on-surface);
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .card-meta {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .category-chip {
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .category-chip.crypto { background: #FFF3E0; color: #E65100; }
        .category-chip.politics { background: #FFEBEE; color: #C62828; }
        .category-chip.sports { background: #E8F5E9; color: #2E7D32; }
        .category-chip.entertainment { background: #FCE4EC; color: #AD1457; }
        .category-chip.science { background: #E3F2FD; color: #1565C0; }
        .category-chip.business { background: #EDE7F6; color: #6A1B9A; }
        .category-chip.other { background: var(--md-surface-container-high); color: var(--md-on-surface-variant); }
        
        [data-theme="dark"] .category-chip.crypto { background: #3E2723; color: #FFB74D; }
        [data-theme="dark"] .category-chip.politics { background: #3E2723; color: #EF9A9A; }
        [data-theme="dark"] .category-chip.sports { background: #1B3A1B; color: #81C784; }
        [data-theme="dark"] .category-chip.entertainment { background: #3E1A2A; color: #F48FB1; }
        [data-theme="dark"] .category-chip.science { background: #0D2137; color: #64B5F6; }
        [data-theme="dark"] .category-chip.business { background: #2A1B3D; color: #B39DDB; }
        
        .date-chip {
            font-size: 12px;
            color: var(--md-on-surface-variant);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .rarity-badge {
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 600;
            margin-left: auto;
        }
        
        .rarity-badge.legendary { background: var(--md-success-container); color: var(--md-success); }
        .rarity-badge.epic { background: var(--md-info-container); color: var(--md-info); }
        .rarity-badge.rare { background: var(--md-warning-container); color: var(--md-warning); }
        .rarity-badge.skip { background: var(--md-error-container); color: var(--md-error); }
        .rarity-badge.pending { background: var(--md-surface-container-high); color: var(--md-on-surface-variant); }
        
        /* Card Stats */
        .card-stats {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            border-bottom: 1px solid var(--md-outline-variant);
        }
        
        .stat-item {
            padding: 12px 8px;
            text-align: center;
            border-right: 1px solid var(--md-outline-variant);
        }
        
        .stat-item:last-child {
            border-right: none;
        }
        
        .stat-label {
            font-size: 10px;
            font-weight: 500;
            color: var(--md-on-surface-variant);
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        
        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--md-on-surface);
        }
        
        .stat-value.positive { color: var(--md-success); }
        .stat-value.negative { color: var(--md-error); }
        .stat-value.neutral { color: var(--md-warning); }
        
        /* Card Input */
        .card-input {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--md-surface-container-high);
        }
        
        .card-input label {
            font-size: 13px;
            color: var(--md-on-surface-variant);
            font-weight: 500;
        }
        
        .card-input .input-field {
            width: 80px;
            padding: 8px 12px;
            font-size: 14px;
        }
        
        .card-input .btn {
            padding: 8px 16px;
            font-size: 13px;
        }
        
        /* Card Footer */
        .card-footer {
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .volume-text {
            font-size: 13px;
            color: var(--md-on-surface-variant);
        }
        
        .volume-text span {
            font-weight: 600;
            color: var(--md-on-surface);
        }
        
        /* Loading & Empty States */
        .loading-state,
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        
        .loading-icon {
            font-size: 48px;
            margin-bottom: 16px;
            animation: bounce 0.6s infinite alternate;
        }
        
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }
        
        .loading-text {
            font-size: 16px;
            color: var(--md-on-surface-variant);
        }
        
        /* Guide Tab */
        .guide-card {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            margin-bottom: 16px;
            overflow: hidden;
        }
        
        .guide-card.highlight {
            border: 2px solid var(--md-primary);
        }
        
        .guide-header {
            padding: 16px 20px;
            background: var(--md-surface-container-high);
            font-size: 16px;
            font-weight: 600;
            color: var(--md-on-surface);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .guide-body {
            padding: 20px;
        }
        
        .guide-body p {
            font-size: 15px;
            color: var(--md-on-surface-variant);
            line-height: 1.8;
            margin-bottom: 12px;
        }
        
        .guide-body strong {
            color: var(--md-on-surface);
        }
        
        /* Portfolio */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .portfolio-card {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            padding: 20px;
        }
        
        .portfolio-card .label {
            font-size: 12px;
            font-weight: 500;
            color: var(--md-on-surface-variant);
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .portfolio-card .value {
            font-size: 28px;
            font-weight: 700;
            color: var(--md-on-surface);
        }
        
        .portfolio-card .value.positive { color: var(--md-success); }
        .portfolio-card .value.negative { color: var(--md-error); }
        
        .portfolio-card .sub {
            font-size: 13px;
            color: var(--md-on-surface-variant);
            margin-top: 4px;
        }
        
        .progress-bar {
            height: 8px;
            background: var(--md-surface-container-high);
            border-radius: 4px;
            margin-top: 12px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--md-error), var(--md-warning), var(--md-success));
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        /* Form Card */
        .form-card {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 24px;
        }
        
        .form-card h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--md-on-surface);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: var(--md-on-surface-variant);
            margin-bottom: 6px;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--md-outline);
            border-radius: var(--radius-sm);
            background: var(--md-surface);
            color: var(--md-on-surface);
            font-family: inherit;
            font-size: 14px;
        }
        
        /* Table */
        .table-container {
            background: var(--md-surface-container);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            padding: 16px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: var(--md-on-surface-variant);
            text-transform: uppercase;
            background: var(--md-surface-container-high);
        }
        
        td {
            padding: 16px;
            font-size: 14px;
            border-bottom: 1px solid var(--md-outline-variant);
        }
        
        .win { color: var(--md-success); }
        .loss { color: var(--md-error); }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }
            
            .main {
                padding: 16px;
            }
            
            .market-grid {
                grid-template-columns: 1fr;
            }
            
            .card-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .stat-item:nth-child(3) {
                border-right: none;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <div class="logo-icon">
                <span class="material-icons-round">analytics</span>
            </div>
            <span class="logo-text">PolyTrader Pro</span>
        </div>
        <div class="header-actions">
            <div class="status-chip" id="statusChip">
                <div class="status-dot"></div>
                <span id="statusText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°">
                <span class="material-icons-round" id="themeIcon">dark_mode</span>
            </button>
        </div>
    </header>
    
    <main class="main">
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('scanner')">
                <span class="material-icons-round">search</span>
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏•‡∏≤‡∏î
            </button>
            <button class="tab-btn" onclick="showTab('portfolio')">
                <span class="material-icons-round">account_balance_wallet</span>
                ‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÇ‡∏ü‡∏•‡∏¥‡πÇ‡∏≠
            </button>
            <button class="tab-btn" onclick="showTab('guide')">
                <span class="material-icons-round">help</span>
                ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </button>
        </div>
        
        <!-- Scanner Tab -->
        <div class="tab-content active" id="tab-scanner">
            <div class="controls-card">
                <div class="controls-row">
                    <div class="control-group">
                        <label>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô ($)</label>
                        <input type="number" class="input-field" id="bankroll" value="100">
                    </div>
                    <div class="control-group">
                        <label>‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á ($)</label>
                        <input type="number" class="input-field" id="betAmount" value="10">
                    </div>
                    <div class="control-group">
                        <label>Edge ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (%)</label>
                        <input type="number" class="input-field" id="minEdge" value="5">
                    </div>
                    <div class="control-group search-field">
                        <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏•‡∏≤‡∏î</label>
                        <input type="text" class="input-field" id="searchInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏•‡∏≤‡∏î ‡πÄ‡∏ä‡πà‡∏ô Bitcoin, Trump..." oninput="filterMarkets()">
                    </div>
                    <button class="btn btn-primary" onclick="fetchMarkets()">
                        <span class="material-icons-round">refresh</span>
                        ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
            </div>
            
            <div class="filter-row">
                <button class="filter-chip active" data-cat="all" onclick="filterCategory('all', this)">üåê ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="filter-chip" data-cat="crypto" onclick="filterCategory('crypto', this)">‚Çø ‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï</button>
                <button class="filter-chip" data-cat="politics" onclick="filterCategory('politics', this)">üèõÔ∏è ‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
                <button class="filter-chip" data-cat="sports" onclick="filterCategory('sports', this)">‚öΩ ‡∏Å‡∏µ‡∏¨‡∏≤</button>
                <button class="filter-chip" data-cat="entertainment" onclick="filterCategory('entertainment', this)">üé¨ ‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á</button>
                <button class="filter-chip" data-cat="science" onclick="filterCategory('science', this)">üî¨ AI/‡∏ß‡∏¥‡∏ó‡∏¢‡πå</button>
                <button class="filter-chip" data-cat="business" onclick="filterCategory('business', this)">üíº ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</button>
            </div>
            
            <div class="stats-row">
                <div>‡∏ï‡∏•‡∏≤‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="totalMarkets">0</span></div>
                <div>‡πÅ‡∏™‡∏î‡∏á: <span id="filteredMarkets">0</span></div>
                <div>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: <span id="lastUpdate">--:--</span></div>
            </div>
            
            <div class="market-grid" id="marketGrid">
                <div class="loading-state">
                    <div class="loading-icon">üìä</div>
                    <div class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏•‡∏≤‡∏î...</div>
                </div>
            </div>
        </div>
        
        <!-- Portfolio Tab -->
        <div class="tab-content" id="tab-portfolio">
            <div class="portfolio-grid">
                <div class="portfolio-card">
                    <div class="label">üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                    <div class="value" id="pBankroll">$100</div>
                    <div class="progress-bar"><div class="progress-fill" id="hpFill" style="width: 100%;"></div></div>
                </div>
                <div class="portfolio-card">
                    <div class="label">üìà ‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</div>
                    <div class="value positive" id="pPnL">+$0</div>
                    <div class="sub" id="pPnLPct">0% ‡∏à‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>
                </div>
                <div class="portfolio-card">
                    <div class="label">üéØ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏∞</div>
                    <div class="value" id="pWinRate">0%</div>
                    <div class="sub" id="pWinLoss">‡∏ä‡∏ô‡∏∞ 0 - ‡πÅ‡∏û‡πâ 0</div>
                </div>
            </div>
            
            <div class="form-card">
                <h3>‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</h3>
                <div class="form-row">
                    <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏•‡∏≤‡∏î</label><input type="text" id="betEvent" placeholder="‡πÄ‡∏ä‡πà‡∏ô BITCOIN >100K"></div>
                    <div class="form-group"><label>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á ($)</label><input type="number" id="betStake" placeholder="10"></div>
                    <div class="form-group"><label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠ (‡πÄ‡∏ã‡∏ô‡∏ï‡πå)</label><input type="number" id="betPrice" placeholder="55"></div>
                    <div class="form-group"><label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label><select id="betStatus"><option value="pending">‚è≥ ‡∏£‡∏≠‡∏ú‡∏•</option><option value="win">‚úÖ ‡∏ä‡∏ô‡∏∞</option><option value="loss">‚ùå ‡πÅ‡∏û‡πâ</option></select></div>
                </div>
                <button class="btn btn-primary" onclick="addBet()">
                    <span class="material-icons-round">add</span>
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                </button>
            </div>
            
            <div class="table-container">
                <table>
                    <thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ï‡∏•‡∏≤‡∏î</th><th>‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á</th><th>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th></th></tr></thead>
                    <tbody id="betsTable"><tr><td colspan="6" style="text-align:center;color:var(--md-on-surface-variant);">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td></tr></tbody>
                </table>
            </div>
        </div>
        
        <!-- Guide Tab -->
        <div class="tab-content" id="tab-guide">
            <div class="guide-card highlight">
                <div class="guide-header">
                    <span class="material-icons-round">lightbulb</span>
                    ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô PolyTrader Pro
                </div>
                <div class="guide-body">
                    <p><strong>1.</strong> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                    <p><strong>2.</strong> ‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡∏ö‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î ‚Üí ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£</p>
                    <p><strong>3.</strong> ‡πÉ‡∏™‡πà Model% (‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á) ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì"</p>
                    <p><strong>4.</strong> ‡∏ñ‡πâ‡∏≤ Edge ‚â• 5% ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô!</p>
                    <p><strong>5.</strong> ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏ó‡∏£‡∏î" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏ô Polymarket</p>
                </div>
            </div>
            
            <div class="guide-card">
                <div class="guide-header">
                    <span class="material-icons-round">calculate</span>
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                </div>
                <div class="guide-body">
                    <p><strong>‡∏£‡∏≤‡∏Ñ‡∏≤ (Price)</strong> = ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏ô Polymarket ‡πÄ‡∏ä‡πà‡∏ô 35¬¢ ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏à‡πà‡∏≤‡∏¢ 35 ‡πÄ‡∏ã‡∏ô‡∏ï‡πå ‡∏ñ‡πâ‡∏≤‡∏ä‡∏ô‡∏∞‡∏à‡∏∞‡πÑ‡∏î‡πâ $1</p>
                    <p><strong>IMPLIED</strong> = ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏£‡∏≤‡∏Ñ‡∏≤ 35¬¢ = ‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 35%)</p>
                    <p><strong>MODEL</strong> = ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á</p>
                    <p><strong>EDGE</strong> = ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á (Model - Implied) ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ï‡πà‡∏≥‡πÑ‡∏õ</p>
                    <p><strong>EV</strong> = Expected Value ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô $100</p>
                </div>
            </div>
            
            <div class="guide-card">
                <div class="guide-header">
                    <span class="material-icons-round">emoji_events</span>
                    ‡∏£‡∏∞‡∏ö‡∏ö Rarity (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô)
                </div>
                <div class="guide-body">
                    <p>üöÄ <strong>LEGENDARY</strong> (Edge ‚â• 10%) = ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏≠‡∏á‡∏´‡∏≤‡∏¢‡∏≤‡∏Å ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!</p>
                    <p>‚ú® <strong>EPIC</strong> (Edge 5-9%) = ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏î‡∏µ ‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô</p>
                    <p>üî∂ <strong>RARE</strong> (Edge 0-4%) = ‡∏û‡∏≠‡πÑ‡∏î‡πâ ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</p>
                    <p>üíÄ <strong>SKIP</strong> (Edge < 0%) = ‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏° ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÄ‡∏•‡∏¢</p>
                </div>
            </div>
            
            <div class="guide-card">
                <div class="guide-header">
                    <span class="material-icons-round">warning</span>
                    ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)
                </div>
                <div class="guide-body">
                    <p>‚ö†Ô∏è <strong>‡∏Å‡∏é 5%</strong> - ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ï‡∏•‡∏≤‡∏î</p>
                    <p>üõë <strong>‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô 20%</strong> - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 80% ‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å</p>
                    <p>‚ùå <strong>‡∏´‡πâ‡∏≤‡∏°‡πÑ‡∏•‡πà‡∏ï‡∏≤‡∏°‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</strong> - ‡πÄ‡∏™‡∏µ‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏∑‡∏ô</p>
                    <p>üìù <strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</strong> - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</p>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        const API_URL = '/api/polymarket';
        let allMarkets = [];
        let currentCategory = 'all';
        let bets = JSON.parse(localStorage.getItem('polytrader_bets') || '[]');
        let isDark = localStorage.getItem('theme') === 'dark';
        
        // Initialize theme
        if (isDark) {
            document.body.setAttribute('data-theme', 'dark');
            document.getElementById('themeIcon').textContent = 'light_mode';
        }
        
        function toggleTheme() {
            isDark = !isDark;
            document.body.setAttribute('data-theme', isDark ? 'dark' : '');
            document.getElementById('themeIcon').textContent = isDark ? 'light_mode' : 'dark_mode';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }
        
        const categoryKeywords = {
            crypto: ['bitcoin', 'btc', 'ethereum', 'eth', 'crypto', 'solana', 'xrp', 'doge', 'defi', 'nft', 'binance', 'coinbase', 'etf'],
            politics: ['trump', 'biden', 'election', 'president', 'congress', 'senate', 'republican', 'democrat', 'xi', 'putin', 'ukraine', 'russia', 'china', 'iran', 'israel', 'gaza', 'war', 'government', 'vote', 'political'],
            sports: ['nba', 'nfl', 'nhl', 'mlb', 'soccer', 'football', 'basketball', 'baseball', 'hockey', 'ufc', 'mma', 'boxing', 'tennis', 'golf', 'olympics', 'championship', 'playoff', 'finals', ' vs '],
            entertainment: ['movie', 'oscar', 'grammy', 'emmy', 'actor', 'actress', 'film', 'album', 'celebrity', 'swift', 'beyonce', 'netflix', 'disney', 'streaming'],
            science: ['ai', 'artificial intelligence', 'openai', 'chatgpt', 'gpt', 'tesla', 'spacex', 'mars', 'nasa', 'space', 'rocket', 'climate', 'vaccine', 'fda', 'quantum', 'robot'],
            business: ['ipo', 'stock', 'merger', 'acquisition', 'ceo', 'company', 'revenue', 'earnings', 'nasdaq', 'fed', 'interest rate', 'inflation', 'recession', 'gdp', 'economy']
        };
        
        const strategies = {
            crypto: {
                icon: '‚Çø',
                name: '‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï',
                howTo: ['‡∏î‡∏π‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞ Technical Analysis ‡∏ö‡∏ô TradingView', '‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Crypto analysts ‡∏ö‡∏ô Twitter/X', '‡∏î‡∏π On-chain data ‡∏à‡∏≤‡∏Å Glassnode', '‡∏®‡∏∂‡∏Å‡∏©‡∏≤ Halving cycles ‡∏Ç‡∏≠‡∏á Bitcoin'],
                tips: ['Bitcoin ‡∏°‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Halving 12-18 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', '‡∏Ç‡πà‡∏≤‡∏ß ETF ‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏π‡∏á', '‡∏î‡∏π Fear & Greed Index ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö'],
                sources: 'TradingView, CoinGecko, Glassnode'
            },
            politics: {
                icon: 'üèõÔ∏è',
                name: '‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                howTo: ['‡∏î‡∏π Polls ‡∏à‡∏≤‡∏Å FiveThirtyEight, RealClearPolitics', '‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏à‡∏≤‡∏Å Reuters, AP News', '‡∏î‡∏π Prediction markets ‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö'],
                tips: ['Polls ‡∏≠‡∏≤‡∏à‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô 3-5%', '‡∏î‡∏π Electoral map ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á'],
                sources: 'FiveThirtyEight, RealClearPolitics'
            },
            sports: {
                icon: '‚öΩ',
                name: '‡∏Å‡∏µ‡∏¨‡∏≤',
                howTo: ['‡∏î‡∏π Odds ‡∏à‡∏≤‡∏Å FanDuel, DraftKings ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô %', '‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πà‡∏≤‡∏ß‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤', '‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ Head-to-head'],
                tips: ['Odds -150 = 60%, +200 = 33%', 'Home advantage ‡∏°‡∏µ‡∏ú‡∏• ~3-5%'],
                sources: 'FanDuel, DraftKings, ESPN'
            },
            entertainment: {
                icon: 'üé¨',
                name: '‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á',
                howTo: ['‡∏î‡∏π Critics reviews ‡πÅ‡∏•‡∏∞ Audience scores', '‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Awards prediction sites', '‡∏î‡∏π Social media buzz'],
                tips: ['Oscar ‡∏°‡∏±‡∏Å‡∏°‡∏µ narrative ‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö', '‡∏î‡∏π Guild awards ‡∏Å‡πà‡∏≠‡∏ô Oscar'],
                sources: 'Rotten Tomatoes, Gold Derby'
            },
            science: {
                icon: 'üî¨',
                name: 'AI/‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå',
                howTo: ['‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß Tech ‡∏à‡∏≤‡∏Å The Verge, TechCrunch', '‡∏î‡∏π Official announcements', '‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° CEO ‡∏ö‡∏ô Twitter/X'],
                tips: ['Tech companies ‡∏°‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤', 'Elon Musk timelines ‡∏°‡∏±‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á'],
                sources: 'The Verge, TechCrunch'
            },
            business: {
                icon: 'üíº',
                name: '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
                howTo: ['‡∏î‡∏π Analyst reports ‡∏à‡∏≤‡∏Å Bloomberg', '‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Fed statements', '‡∏î‡∏π Economic indicators'],
                tips: ['Fed ‡∏°‡∏±‡∏Å‡∏ö‡∏≠‡∏Å forward guidance ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤', '‡∏î‡∏π CME FedWatch ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö rate predictions'],
                sources: 'Bloomberg, Reuters, CNBC'
            },
            other: {
                icon: 'üìä',
                name: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
                howTo: ['‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡∏±‡πâ‡∏ô', '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πà‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á'],
                tips: ['‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏ó‡∏£‡∏î'],
                sources: 'Google News'
            }
        };
        
        function detectCategory(title, slug) {
            const text = (title + ' ' + slug).toLowerCase();
            for (const [cat, keywords] of Object.entries(categoryKeywords)) {
                for (const kw of keywords) {
                    if (text.includes(kw)) return cat;
                }
            }
            return 'other';
        }
        
        function showTab(name) {
            document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.closest('.tab-btn').classList.add('active');
            document.getElementById(`tab-${name}`).classList.add('active');
            if (name === 'portfolio') updatePortfolio();
        }
        
        function generateOverlayHTML(m) {
            const s = strategies[m.category] || strategies.other;
            const betAmount = parseFloat(document.getElementById('betAmount').value) || 10;
            const priceYes = m.price;
            const priceNo = 1 - m.price;
            
            // Calculate profits
            const sharesYes = betAmount / priceYes;
            const profitYes = sharesYes - betAmount;
            const sharesNo = betAmount / priceNo;
            const profitNo = sharesNo - betAmount;
            
            // Recommended sell price (if price increases)
            const targetSellYes = Math.min(0.95, priceYes + 0.15);
            const sellProfitYes = ((targetSellYes - priceYes) / priceYes * 100).toFixed(0);
            
            return `
                <div class="overlay-header">
                    <span>${s.icon}</span>
                    <h3>‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå: ${s.name}</h3>
                </div>
                
                <div class="overlay-section">
                    <h4>üí∞ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£ (‡∏•‡∏á $${betAmount})</h4>
                    <div class="profit-box">
                        <div class="profit-row">
                            <span class="profit-label">‡∏ã‡∏∑‡πâ‡∏≠ YES ‡∏ó‡∏µ‡πà ${(priceYes*100).toFixed(0)}¬¢</span>
                            <span class="profit-value">‡πÑ‡∏î‡πâ ${sharesYes.toFixed(2)} ‡∏´‡∏∏‡πâ‡∏ô</span>
                        </div>
                        <div class="profit-row">
                            <span class="profit-label">‚Üí ‡∏ñ‡πâ‡∏≤‡∏ä‡∏ô‡∏∞ (YES ‡∏ñ‡∏π‡∏Å)</span>
                            <span class="profit-value positive">+$${profitYes.toFixed(2)}</span>
                        </div>
                        <div class="profit-row">
                            <span class="profit-label">‚Üí ‡∏ñ‡πâ‡∏≤‡πÅ‡∏û‡πâ (NO ‡∏ñ‡∏π‡∏Å)</span>
                            <span class="profit-value negative">-$${betAmount.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    <div class="profit-box">
                        <div class="profit-row">
                            <span class="profit-label">‡∏ã‡∏∑‡πâ‡∏≠ NO ‡∏ó‡∏µ‡πà ${(priceNo*100).toFixed(0)}¬¢</span>
                            <span class="profit-value">‡πÑ‡∏î‡πâ ${sharesNo.toFixed(2)} ‡∏´‡∏∏‡πâ‡∏ô</span>
                        </div>
                        <div class="profit-row">
                            <span class="profit-label">‚Üí ‡∏ñ‡πâ‡∏≤‡∏ä‡∏ô‡∏∞ (NO ‡∏ñ‡∏π‡∏Å)</span>
                            <span class="profit-value positive">+$${profitNo.toFixed(2)}</span>
                        </div>
                        <div class="profit-row">
                            <span class="profit-label">‚Üí ‡∏ñ‡πâ‡∏≤‡πÅ‡∏û‡πâ (YES ‡∏ñ‡∏π‡∏Å)</span>
                            <span class="profit-value negative">-$${betAmount.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    <div class="highlight-box">
                        üí° <strong>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ YES ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ${(targetSellYes*100).toFixed(0)}¬¢ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏≤‡∏¢‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£ ~${sellProfitYes}%
                    </div>
                </div>
                
                <div class="overlay-section">
                    <h4>üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏≤ Model%</h4>
                    <ul>
                        ${s.howTo.map(h => `<li>${h}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="overlay-section">
                    <h4>üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö</h4>
                    <ul>
                        ${s.tips.map(t => `<li>${t}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="overlay-section">
                    <h4>üìö ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
                    <p>${s.sources}</p>
                </div>
                
                <div class="overlay-footer">
                    <a href="${m.url}" target="_blank" class="btn btn-primary" onclick="event.stopPropagation()">
                        <span class="material-icons-round">launch</span>
                        ‡πÑ‡∏õ‡πÄ‡∏ó‡∏£‡∏î‡πÄ‡∏•‡∏¢!
                    </a>
                </div>
            `;
        }
        
        async function fetchMarkets() {
            const grid = document.getElementById('marketGrid');
            const chip = document.getElementById('statusChip');
            const text = document.getElementById('statusText');
            
            grid.innerHTML = '<div class="loading-state"><div class="loading-icon">üìä</div><div class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏•‡∏≤‡∏î...</div></div>';
            chip.classList.remove('offline');
            text.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
            
            try {
                const response = await fetch(`${API_URL}?endpoint=events&closed=false&limit=200`);
                if (!response.ok) throw new Error(`Error ${response.status}`);
                const events = await response.json();
                
                allMarkets = events.map(e => {
                    const m = e.markets?.[0] || {};
                    let price = 0;
                    if (m.outcomePrices) { try { price = parseFloat(JSON.parse(m.outcomePrices)[0]) || 0; } catch {} }
                    return {
                        id: e.id,
                        title: e.title || 'Unknown',
                        slug: e.slug || '',
                        endDate: e.endDate,
                        category: detectCategory(e.title || '', e.slug || ''),
                        price,
                        volume: parseFloat(m.volume) || 0,
                        url: `https://polymarket.com/event/${e.slug}`
                    };
                }).filter(m => m.price > 0.01 && m.price < 0.99);
                
                allMarkets.sort((a, b) => b.volume - a.volume);
                
                text.textContent = `‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß ¬∑ ${allMarkets.length} ‡∏ï‡∏•‡∏≤‡∏î`;
                document.getElementById('totalMarkets').textContent = allMarkets.length;
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'});
                filterMarkets();
            } catch (err) {
                chip.classList.add('offline');
                text.textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ';
                grid.innerHTML = `<div class="empty-state"><div class="loading-icon">‚ùå</div><div class="loading-text">‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${err.message}</div><button class="btn btn-primary" onclick="fetchMarkets()" style="margin-top:16px;">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button></div>`;
            }
        }
        
        function filterCategory(cat, btn) {
            currentCategory = cat;
            document.querySelectorAll('.filter-chip').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            filterMarkets();
        }
        
        function filterMarkets() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            let filtered = allMarkets;
            if (currentCategory !== 'all') filtered = filtered.filter(m => m.category === currentCategory);
            if (search) filtered = filtered.filter(m => m.title.toLowerCase().includes(search) || m.slug.toLowerCase().includes(search));
            document.getElementById('filteredMarkets').textContent = filtered.length;
            renderMarkets(filtered);
        }
        
        function renderMarkets(markets) {
            const grid = document.getElementById('marketGrid');
            if (!markets.length) { grid.innerHTML = '<div class="empty-state"><div class="loading-icon">üîç</div><div class="loading-text">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</div></div>'; return; }
            
            const catNames = { crypto: '‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï', politics: '‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á', sports: '‡∏Å‡∏µ‡∏¨‡∏≤', entertainment: '‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á', science: 'AI/‡∏ß‡∏¥‡∏ó‡∏¢‡πå', business: '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', other: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' };
            
            grid.innerHTML = markets.slice(0, 50).map((m, i) => {
                const endDate = m.endDate ? new Date(m.endDate).toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: '2-digit' }) : '';
                
                return `
                    <div class="market-card" id="card-${i}">
                        <div class="hover-overlay">
                            ${generateOverlayHTML(m)}
                        </div>
                        
                        <div class="card-header">
                            <div class="card-title">${m.title}</div>
                            <div class="card-meta">
                                <span class="category-chip ${m.category}">${catNames[m.category] || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'}</span>
                                ${endDate ? `<span class="date-chip"><span class="material-icons-round" style="font-size:14px;">event</span>${endDate}</span>` : ''}
                                <span class="rarity-badge pending" id="badge-${i}">‡πÉ‡∏™‡πà Model%</span>
                            </div>
                        </div>
                        
                        <div class="card-stats">
                            <div class="stat-item"><div class="stat-label">‡∏£‡∏≤‡∏Ñ‡∏≤</div><div class="stat-value">${(m.price*100).toFixed(0)}¬¢</div></div>
                            <div class="stat-item"><div class="stat-label">Implied</div><div class="stat-value">${(m.price*100).toFixed(1)}%</div></div>
                            <div class="stat-item"><div class="stat-label">Model</div><div class="stat-value" id="model-${i}">--</div></div>
                            <div class="stat-item"><div class="stat-label">Edge</div><div class="stat-value" id="edge-${i}">--</div></div>
                            <div class="stat-item"><div class="stat-label">EV</div><div class="stat-value" id="ev-${i}">--</div></div>
                        </div>
                        
                        <div class="card-input">
                            <label>Model%:</label>
                            <input type="number" class="input-field" id="input-${i}" placeholder="65" min="1" max="99" onclick="event.stopPropagation()">
                            <button class="btn btn-success" onclick="event.stopPropagation(); calculate(${i}, ${m.price})">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
                        </div>
                        
                        <div class="card-footer">
                            <span class="volume-text">Volume: <span>$${formatNum(m.volume)}</span></span>
                            <a href="${m.url}" target="_blank" class="btn btn-tonal" onclick="event.stopPropagation()">
                                <span class="material-icons-round">launch</span>
                                ‡πÄ‡∏ó‡∏£‡∏î
                            </a>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function calculate(i, price) {
            const model = parseFloat(document.getElementById(`input-${i}`).value);
            if (!model || model < 1 || model > 99) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Model% ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 1-99'); return; }
            const minEdge = parseFloat(document.getElementById('minEdge').value) || 5;
            const edge = model - (price * 100);
            const ev = ((model / 100) * (100 * (1/price - 1))) - ((1 - model / 100) * 100);
            
            document.getElementById(`model-${i}`).textContent = `${model}%`;
            document.getElementById(`model-${i}`).className = 'stat-value positive';
            
            const edgeEl = document.getElementById(`edge-${i}`);
            edgeEl.textContent = `${edge >= 0 ? '+' : ''}${edge.toFixed(0)}%`;
            edgeEl.className = `stat-value ${edge >= minEdge ? 'positive' : edge >= 0 ? 'neutral' : 'negative'}`;
            
            const evEl = document.getElementById(`ev-${i}`);
            evEl.textContent = `${ev >= 0 ? '+' : ''}$${ev.toFixed(0)}`;
            evEl.className = `stat-value ${ev >= 0 ? 'positive' : 'negative'}`;
            
            const badge = document.getElementById(`badge-${i}`);
            const card = document.getElementById(`card-${i}`);
            
            if (edge >= 10) { badge.textContent = 'üöÄ LEGENDARY'; badge.className = 'rarity-badge legendary'; }
            else if (edge >= minEdge) { badge.textContent = '‚ú® EPIC'; badge.className = 'rarity-badge epic'; }
            else if (edge >= 0) { badge.textContent = 'üî∂ RARE'; badge.className = 'rarity-badge rare'; }
            else { badge.textContent = 'üíÄ SKIP'; badge.className = 'rarity-badge skip'; }
        }
        
        function addBet() {
            const event = document.getElementById('betEvent').value;
            const stake = parseFloat(document.getElementById('betStake').value);
            const price = parseFloat(document.getElementById('betPrice').value) / 100;
            const status = document.getElementById('betStatus').value;
            if (!event || !stake || !price) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö'); return; }
            const pnl = status === 'win' ? (stake / price) - stake : status === 'loss' ? -stake : 0;
            bets.unshift({ id: Date.now(), date: new Date().toISOString(), event, stake, price, status, pnl });
            localStorage.setItem('polytrader_bets', JSON.stringify(bets));
            document.getElementById('betEvent').value = '';
            document.getElementById('betStake').value = '';
            document.getElementById('betPrice').value = '';
            updatePortfolio();
        }
        
        function updateStatus(id, status) {
            const bet = bets.find(b => b.id === id);
            if (bet) { bet.status = status; bet.pnl = status === 'win' ? (bet.stake / bet.price) - bet.stake : status === 'loss' ? -bet.stake : 0; localStorage.setItem('polytrader_bets', JSON.stringify(bets)); updatePortfolio(); }
        }
        
        function deleteBet(id) { if (confirm('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) { bets = bets.filter(b => b.id !== id); localStorage.setItem('polytrader_bets', JSON.stringify(bets)); updatePortfolio(); } }
        
        function updatePortfolio() {
            const bankroll = parseFloat(document.getElementById('bankroll').value) || 100;
            const wins = bets.filter(b => b.status === 'win');
            const losses = bets.filter(b => b.status === 'loss');
            const totalPnL = bets.reduce((s, b) => s + b.pnl, 0);
            const current = bankroll + totalPnL;
            const winRate = wins.length + losses.length > 0 ? (wins.length / (wins.length + losses.length) * 100).toFixed(0) : 0;
            
            document.getElementById('pBankroll').textContent = `$${current.toFixed(0)}`;
            document.getElementById('pPnL').textContent = `${totalPnL >= 0 ? '+' : ''}$${totalPnL.toFixed(2)}`;
            document.getElementById('pPnL').className = `value ${totalPnL >= 0 ? 'positive' : 'negative'}`;
            document.getElementById('pPnLPct').textContent = `${(totalPnL / bankroll * 100).toFixed(1)}% ‡∏à‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô`;
            document.getElementById('pWinRate').textContent = `${winRate}%`;
            document.getElementById('pWinLoss').textContent = `‡∏ä‡∏ô‡∏∞ ${wins.length} - ‡πÅ‡∏û‡πâ ${losses.length}`;
            document.getElementById('hpFill').style.width = `${Math.max(0, Math.min(100, (current / bankroll) * 100))}%`;
            
            const tbody = document.getElementById('betsTable');
            if (!bets.length) { tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--md-on-surface-variant);">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td></tr>'; return; }
            tbody.innerHTML = bets.map(b => {
                const date = new Date(b.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' });
                const pnlClass = b.status === 'win' ? 'win' : b.status === 'loss' ? 'loss' : '';
                return `<tr><td>${date}</td><td>${b.event}</td><td>$${b.stake}</td><td class="${pnlClass}">${b.pnl >= 0 ? '+' : ''}$${b.pnl.toFixed(2)}</td><td><select onchange="updateStatus(${b.id}, this.value)" style="padding:8px;border:1px solid var(--md-outline);border-radius:8px;background:var(--md-surface);color:var(--md-on-surface);font-family:inherit;"><option value="pending" ${b.status === 'pending' ? 'selected' : ''}>‚è≥ ‡∏£‡∏≠‡∏ú‡∏•</option><option value="win" ${b.status === 'win' ? 'selected' : ''}>‚úÖ ‡∏ä‡∏ô‡∏∞</option><option value="loss" ${b.status === 'loss' ? 'selected' : ''}>‚ùå ‡πÅ‡∏û‡πâ</option></select></td><td><button onclick="deleteBet(${b.id})" style="padding:8px 12px;background:var(--md-error-container);color:var(--md-error);border:none;border-radius:8px;cursor:pointer;font-family:inherit;">‡∏•‡∏ö</button></td></tr>`;
            }).join('');
        }
        
        function formatNum(n) { if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M'; if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K'; return n.toFixed(0); }
        
        fetchMarkets();
    </script>
</body>
</html>
